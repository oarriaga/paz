
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Modular Robot Perception library in Python.">
      
      
      
      
        <link rel="prev" href="../draw/">
      
      
        <link rel="next" href="../keypoints/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.4">
    
    
      
        <title>Boxes - PAZ - Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.8608ea7d.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="orange" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#apply_non_max_suppression" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="PAZ - Documentation" class="md-header__button md-logo" aria-label="PAZ - Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            PAZ - Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Boxes
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/oarriaga/paz" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    oarriaga/paz
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="PAZ - Documentation" class="md-nav__button md-logo" aria-label="PAZ - Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    PAZ - Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/oarriaga/paz" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    oarriaga/paz
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting-started
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contributing
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Tutorials
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/introduction_to_processors/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Intro to processors
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/image_augmentation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Image augmentation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/bounding_boxes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bounding boxes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/controlmap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Control-map
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/object_detection_pipeline/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Object detection pipeline
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Models
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Models
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../models/detection/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Detection
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../models/keypoint/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Keypoints
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../models/classification/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Classification
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../models/layers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Layers
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Pipelines (high-level)
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Pipelines (high-level)
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pipelines/applications/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Applications
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pipelines/image/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Image
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pipelines/detection/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Detection
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pipelines/keypoints/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Keypoints
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pipelines/pose/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pose
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pipelines/renderer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Renderer
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Processors (mid-level)
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Processors (mid-level)
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../processors/image/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Image
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../processors/draw/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Draw
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../processors/detection/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Detection
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../processors/geometric/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Geometric
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../processors/keypoints/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Keypoints
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../processors/standard/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Standard
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../processors/pose/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pose
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../processors/renderer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Renderer
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" checked>
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Backends (low-level)
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Backends (low-level)
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../image/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Image
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../draw/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Draw
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Boxes
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Boxes
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#apply_non_max_suppression" class="md-nav__link">
    <span class="md-ellipsis">
      apply_non_max_suppression
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nms_per_class" class="md-nav__link">
    <span class="md-ellipsis">
      nms_per_class
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_nms_per_class" class="md-nav__link">
    <span class="md-ellipsis">
      _nms_per_class
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pre_filter_nms" class="md-nav__link">
    <span class="md-ellipsis">
      pre_filter_nms
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#merge_nms_box_with_class" class="md-nav__link">
    <span class="md-ellipsis">
      merge_nms_box_with_class
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#suppress_other_class_scores" class="md-nav__link">
    <span class="md-ellipsis">
      suppress_other_class_scores
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#offset" class="md-nav__link">
    <span class="md-ellipsis">
      offset
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#clip" class="md-nav__link">
    <span class="md-ellipsis">
      clip
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#compute_iou" class="md-nav__link">
    <span class="md-ellipsis">
      compute_iou
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#compute_ious" class="md-nav__link">
    <span class="md-ellipsis">
      compute_ious
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#decode" class="md-nav__link">
    <span class="md-ellipsis">
      decode
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#denormalize_box" class="md-nav__link">
    <span class="md-ellipsis">
      denormalize_box
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#encode" class="md-nav__link">
    <span class="md-ellipsis">
      encode
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#flip_left_right" class="md-nav__link">
    <span class="md-ellipsis">
      flip_left_right
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#make_box_square" class="md-nav__link">
    <span class="md-ellipsis">
      make_box_square
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#match" class="md-nav__link">
    <span class="md-ellipsis">
      match
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nms_per_class_1" class="md-nav__link">
    <span class="md-ellipsis">
      nms_per_class
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#to_image_coordinates" class="md-nav__link">
    <span class="md-ellipsis">
      to_image_coordinates
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#to_center_form" class="md-nav__link">
    <span class="md-ellipsis">
      to_center_form
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#to_one_hot" class="md-nav__link">
    <span class="md-ellipsis">
      to_one_hot
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#to_normalized_coordinates" class="md-nav__link">
    <span class="md-ellipsis">
      to_normalized_coordinates
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#to_corner_form" class="md-nav__link">
    <span class="md-ellipsis">
      to_corner_form
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extract_bounding_box_corners" class="md-nav__link">
    <span class="md-ellipsis">
      extract_bounding_box_corners
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#scale_box" class="md-nav__link">
    <span class="md-ellipsis">
      scale_box
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#change_box_coordinates" class="md-nav__link">
    <span class="md-ellipsis">
      change_box_coordinates
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#add_class_and_score" class="md-nav__link">
    <span class="md-ellipsis">
      add_class_and_score
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../keypoints/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Keypoints
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../quaternion/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quaternions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../camera/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Camera
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../render/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Render
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Abstract (core)
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            Abstract (core)
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../abstract/messages/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Messages
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../abstract/processor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Processor
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../abstract/sequence/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sequence
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../abstract/loader/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Loader
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Additional functionality
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            Additional functionality
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../datasets/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Datasets
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../optimization/losses/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Losses
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../optimization/callbacks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Callbacks
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#apply_non_max_suppression" class="md-nav__link">
    <span class="md-ellipsis">
      apply_non_max_suppression
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nms_per_class" class="md-nav__link">
    <span class="md-ellipsis">
      nms_per_class
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_nms_per_class" class="md-nav__link">
    <span class="md-ellipsis">
      _nms_per_class
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pre_filter_nms" class="md-nav__link">
    <span class="md-ellipsis">
      pre_filter_nms
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#merge_nms_box_with_class" class="md-nav__link">
    <span class="md-ellipsis">
      merge_nms_box_with_class
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#suppress_other_class_scores" class="md-nav__link">
    <span class="md-ellipsis">
      suppress_other_class_scores
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#offset" class="md-nav__link">
    <span class="md-ellipsis">
      offset
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#clip" class="md-nav__link">
    <span class="md-ellipsis">
      clip
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#compute_iou" class="md-nav__link">
    <span class="md-ellipsis">
      compute_iou
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#compute_ious" class="md-nav__link">
    <span class="md-ellipsis">
      compute_ious
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#decode" class="md-nav__link">
    <span class="md-ellipsis">
      decode
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#denormalize_box" class="md-nav__link">
    <span class="md-ellipsis">
      denormalize_box
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#encode" class="md-nav__link">
    <span class="md-ellipsis">
      encode
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#flip_left_right" class="md-nav__link">
    <span class="md-ellipsis">
      flip_left_right
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#make_box_square" class="md-nav__link">
    <span class="md-ellipsis">
      make_box_square
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#match" class="md-nav__link">
    <span class="md-ellipsis">
      match
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nms_per_class_1" class="md-nav__link">
    <span class="md-ellipsis">
      nms_per_class
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#to_image_coordinates" class="md-nav__link">
    <span class="md-ellipsis">
      to_image_coordinates
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#to_center_form" class="md-nav__link">
    <span class="md-ellipsis">
      to_center_form
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#to_one_hot" class="md-nav__link">
    <span class="md-ellipsis">
      to_one_hot
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#to_normalized_coordinates" class="md-nav__link">
    <span class="md-ellipsis">
      to_normalized_coordinates
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#to_corner_form" class="md-nav__link">
    <span class="md-ellipsis">
      to_corner_form
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extract_bounding_box_corners" class="md-nav__link">
    <span class="md-ellipsis">
      extract_bounding_box_corners
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#scale_box" class="md-nav__link">
    <span class="md-ellipsis">
      scale_box
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#change_box_coordinates" class="md-nav__link">
    <span class="md-ellipsis">
      change_box_coordinates
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#add_class_and_score" class="md-nav__link">
    <span class="md-ellipsis">
      add_class_and_score
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


  <h1>Boxes</h1>

<p>Backend functionality for 2D bounding boxes</p>
<p><span style="float:right;"><a href="https://github.com/oarriaga/paz/blob/master/paz/backend/boxes.py#L249">[source]</a></span></p>
<h3 id="apply_non_max_suppression">apply_non_max_suppression</h3>
<div class="codehilite"><pre><span></span><code><span class="n">paz</span><span class="o">.</span><span class="n">backend</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">apply_non_max_suppression</span><span class="p">(</span><span class="n">boxes</span><span class="p">,</span> <span class="n">scores</span><span class="p">,</span> <span class="n">iou_thresh</span><span class="o">=</span><span class="mf">0.45</span><span class="p">,</span> <span class="n">top_k</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
</code></pre></div>

<p>Apply non maximum suppression.</p>
<p><strong>Arguments</strong></p>
<ul>
<li><strong>boxes</strong>: Numpy array, box coordinates of shape <code>(num_boxes, 4)</code>
    where each columns corresponds to x_min, y_min, x_max, y_max.</li>
<li><strong>scores</strong>: Numpy array, of scores given for each box in <code>boxes</code>.</li>
<li><strong>iou_thresh</strong>: float, intersection over union threshold for removing
    boxes.</li>
<li><strong>top_k</strong>: int, number of maximum objects per class.</li>
</ul>
<p><strong>Returns</strong></p>
<ul>
<li><strong>selected_indices</strong>: Numpy array, selected indices of kept boxes.</li>
<li><strong>num_selected_boxes</strong>: int, number of selected boxes.</li>
</ul>
<hr />
<p><span style="float:right;"><a href="https://github.com/oarriaga/paz/blob/master/paz/backend/boxes.py#L319">[source]</a></span></p>
<h3 id="nms_per_class">nms_per_class</h3>
<div class="codehilite"><pre><span></span><code><span class="n">paz</span><span class="o">.</span><span class="n">backend</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">nms_per_class</span><span class="p">(</span><span class="n">box_data</span><span class="p">,</span> <span class="n">nms_thresh</span><span class="o">=</span><span class="mf">0.45</span><span class="p">,</span> <span class="n">epsilon</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">top_k</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
</code></pre></div>

<p>Applies non maximum suppression per class.
This function takes all the detections from the detector which
consists of boxes and their corresponding class scores to which it
applies non maximum suppression for every class independently and
then combines the result.</p>
<p><strong>Arguments</strong></p>
<ul>
<li><strong>box_data</strong>: Array of shape <code>(num_nms_boxes, 4 + num_classes)</code>
    containing the box coordinates as well as the predicted
    scores of all the classes for all non suppressed boxes.</li>
<li><strong>nms_thresh</strong>: Float, Non-maximum suppression threshold.</li>
<li><strong>epsilon</strong>: Float, Filter scores with a lower confidence
    value before performing non-maximum supression.</li>
<li><strong>top_k</strong>: Int, Maximum number of boxes per class outputted by nms.</li>
</ul>
<p><strong>Returns</strong></p>
<ul>
<li><strong>Tuple</strong>: Containing an array non suppressed boxes of shape
    <code>(num_nms_boxes, 4 + num_classes)</code> and an array
    of corresponding class labels of shape <code>(num_nms_boxes, )</code>.</li>
</ul>
<hr />
<p><span style="float:right;"><a href="https://github.com/oarriaga/paz/blob/master/paz/backend/boxes.py#L352">[source]</a></span></p>
<h3 id="_nms_per_class">_nms_per_class</h3>
<div class="codehilite"><pre><span></span><code><span class="n">paz</span><span class="o">.</span><span class="n">backend</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">_nms_per_class</span><span class="p">(</span><span class="n">nms_boxes</span><span class="p">,</span> <span class="n">class_labels</span><span class="p">,</span> <span class="n">class_arg</span><span class="p">,</span> <span class="n">decoded_boxes</span><span class="p">,</span> <span class="n">class_predictions</span><span class="p">,</span> <span class="n">epsilon</span><span class="p">,</span> <span class="n">nms_thresh</span><span class="p">,</span> <span class="n">top_k</span><span class="p">)</span>
</code></pre></div>

<p>Applies non maximum suppression for a given class.
This function takes all the detections that belong only to the given
single class and applies non maximum suppression for that class
alone and returns the resulting non suppressed boxes.</p>
<p><strong>Arguments</strong></p>
<ul>
<li><strong>nms_boxes</strong>: Array of shape <code>(num_boxes, 4 + num_classes)</code>.</li>
<li><strong>class_labels</strong>: Array of shape <code>(num_boxes, )</code>.</li>
<li><strong>class_arg</strong>: Int, class index.</li>
<li><strong>decoded_boxes</strong>: Array of shape <code>(num_prior_boxes, 4)</code>
    containing the box coordinates of all the
    non suppressed boxes.</li>
<li><strong>class_predictions</strong>: Array of shape
    <code>(num_nms_boxes, num_classes)</code> containing the predicted
    scores of all the classes for all the non suppressed boxes.</li>
<li><strong>epsilon</strong>: Float, Filter scores with a lower confidence
    value before performing non-maximum supression.</li>
<li><strong>nms_thresh</strong>: Float, Non-maximum suppression threshold.</li>
<li><strong>top_k</strong>: Int, Maximum number of boxes per class outputted by nms.</li>
</ul>
<p><strong>Returns</strong></p>
<ul>
<li><strong>Tuple</strong>: Containing an array non suppressed boxes per class of
    shape <code>(num_nms_boxes_per_class, 4 + num_classes) and an
    array corresponding class labels of shape</code>(num_nms_boxes_per_class, )`.</li>
</ul>
<hr />
<p><span style="float:right;"><a href="https://github.com/oarriaga/paz/blob/master/paz/backend/boxes.py#L396">[source]</a></span></p>
<h3 id="pre_filter_nms">pre_filter_nms</h3>
<div class="codehilite"><pre><span></span><code><span class="n">paz</span><span class="o">.</span><span class="n">backend</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">pre_filter_nms</span><span class="p">(</span><span class="n">class_arg</span><span class="p">,</span> <span class="n">class_predictions</span><span class="p">,</span> <span class="n">epsilon</span><span class="p">)</span>
</code></pre></div>

<p>Applies score filtering.
This function takes all the predicted scores of a given class and
filters out all the predictions less than the given <code>epsilon</code> value.</p>
<p><strong>Arguments</strong></p>
<ul>
<li><strong>class_arg</strong>: Int, class index.</li>
<li><strong>class_predictions</strong>: Array of shape
    <code>(num_nms_boxes, num_classes)</code> containing the predicted
    scores of all the classes for all the non suppressed boxes.</li>
<li><strong>epsilon</strong>: Float, threshold value for score filtering.</li>
</ul>
<p><strong>Returns</strong></p>
<ul>
<li><strong>Tuple</strong>: Containing an array filtered scores of shape
    <code>(num_pre_filtered_boxes, )</code> and an array filter mask of
    shape <code>(num_prior_boxes, )</code>.</li>
</ul>
<hr />
<p><span style="float:right;"><a href="https://github.com/oarriaga/paz/blob/master/paz/backend/boxes.py#L418">[source]</a></span></p>
<h3 id="merge_nms_box_with_class">merge_nms_box_with_class</h3>
<div class="codehilite"><pre><span></span><code><span class="n">paz</span><span class="o">.</span><span class="n">backend</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">merge_nms_box_with_class</span><span class="p">(</span><span class="n">box_data</span><span class="p">,</span> <span class="n">class_labels</span><span class="p">)</span>
</code></pre></div>

<p>Merges box coordinates with their corresponding class
defined by <code>class_labels</code> which is decided by best box geometry
by non maximum suppression (and not by the best scoring class)
into a single output.
This function retains only the predicted score of the class to
which the box belongs to and sets the scores of all the remaining
classes to zero, thereby combining box and class information in a
single variable.</p>
<p><strong>Arguments</strong></p>
<ul>
<li><strong>box_data</strong>: Array of shape <code>(num_nms_boxes, 4 + num_classes)</code>
    containing the box coordinates as well as the predicted
    scores of all the classes for all non suppressed boxes.</li>
<li><strong>class_labels</strong>: Array of shape <code>(num_nms_boxes, )</code> that contains
    the indices of the class whose score is to be retained.</li>
</ul>
<p><strong>Returns</strong></p>
<ul>
<li><strong>boxes</strong>: Array of shape <code>(num_nms_boxes, 4 + num_classes)</code>,
    containing coordinates of non supressed boxes along with
    scores of the class to which the box belongs. The scores of
    the other classes are zeros.</li>
</ul>
<hr />
<p><span style="float:right;"><a href="https://github.com/oarriaga/paz/blob/master/paz/backend/boxes.py#L449">[source]</a></span></p>
<h3 id="suppress_other_class_scores">suppress_other_class_scores</h3>
<div class="codehilite"><pre><span></span><code><span class="n">paz</span><span class="o">.</span><span class="n">backend</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">suppress_other_class_scores</span><span class="p">(</span><span class="n">class_predictions</span><span class="p">,</span> <span class="n">class_labels</span><span class="p">)</span>
</code></pre></div>

<p>Retains the score of class in <code>class_labels</code> and
sets other class scores to zero.</p>
<p><strong>Arguments</strong></p>
<ul>
<li><strong>class_predictions</strong>: Array of shape
    <code>(num_nms_boxes, num_classes)</code> containing the predicted
    scores of all the classes for all the non suppressed boxes.</li>
<li><strong>class_labels</strong>: Array of shape <code>(num_nms_boxes, )</code> that contains
    the indices of the class whose score is to be retained.</li>
</ul>
<p><strong>Returns</strong></p>
<ul>
<li><strong>retained_class_score</strong>: Array of shape
    <code>(num_nms_boxes, num_classes)</code> that consists of score at
    only those location specified by 'class_labels' and zero
    at other class locations.</li>
</ul>
<p><strong>Note</strong></p>
<p>This approach retains the scores of that class in
<code>class_predictions</code> defined by <code>class_labels</code> by generating
a boolean mask <code>score_suppress_mask</code> with elements True at the
locations where the score in <code>class_predictions</code> is to be
retained and False wherever the class score is to be suppressed.
This approach of retaining/suppressing scores does not make use
of for loop, if-else condition and direct value assignment
to arrays.</p>
<hr />
<p><span style="float:right;"><a href="https://github.com/oarriaga/paz/blob/master/paz/backend/boxes.py#L542">[source]</a></span></p>
<h3 id="offset">offset</h3>
<div class="codehilite"><pre><span></span><code><span class="n">paz</span><span class="o">.</span><span class="n">backend</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">offset</span><span class="p">(</span><span class="n">coordinates</span><span class="p">,</span> <span class="n">offset_scales</span><span class="p">)</span>
</code></pre></div>

<p>Apply offsets to box coordinates</p>
<p><strong>Arguments</strong></p>
<ul>
<li><strong>coordinates</strong>: List of floats containing coordinates in point form.</li>
<li><strong>offset_scales</strong>: List of floats having x and y scales respectively.</li>
</ul>
<p><strong>Returns</strong></p>
<ul>
<li><strong>coordinates</strong>: List of floats containing coordinates in point form.
    i.e. [x_min, y_min, x_max, y_max].</li>
</ul>
<hr />
<p><span style="float:right;"><a href="https://github.com/oarriaga/paz/blob/master/paz/backend/boxes.py#L564">[source]</a></span></p>
<h3 id="clip">clip</h3>
<div class="codehilite"><pre><span></span><code><span class="n">paz</span><span class="o">.</span><span class="n">backend</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">coordinates</span><span class="p">,</span> <span class="n">image_shape</span><span class="p">)</span>
</code></pre></div>

<p>Clip box to valid image coordinates
<strong>Arguments</strong></p>
<ul>
<li><strong>coordinates</strong>: List of floats containing coordinates in point form
    i.e. [x_min, y_min, x_max, y_max].</li>
<li><strong>image_shape</strong>: List of two integers indicating height and width of image
    respectively.</li>
</ul>
<p><strong>Returns</strong></p>
<p>List of clipped coordinates.</p>
<hr />
<p><span style="float:right;"><a href="https://github.com/oarriaga/paz/blob/master/paz/backend/boxes.py#L218">[source]</a></span></p>
<h3 id="compute_iou">compute_iou</h3>
<div class="codehilite"><pre><span></span><code><span class="n">paz</span><span class="o">.</span><span class="n">backend</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">compute_iou</span><span class="p">(</span><span class="n">box</span><span class="p">,</span> <span class="n">boxes</span><span class="p">)</span>
</code></pre></div>

<p>Calculates the intersection over union between 'box' and all 'boxes'.
Both <code>box</code> and <code>boxes</code> are in corner coordinates.</p>
<p><strong>Arguments</strong></p>
<ul>
<li><strong>box</strong>: Numpy array with length at least of 4.</li>
<li><strong>boxes</strong>: Numpy array with shape <code>(num_boxes, 4)</code>.</li>
</ul>
<p><strong>Returns</strong></p>
<p>Numpy array of shape <code>(num_boxes, 1)</code>.</p>
<hr />
<p><span style="float:right;"><a href="https://github.com/oarriaga/paz/blob/master/paz/backend/boxes.py#L92">[source]</a></span></p>
<h3 id="compute_ious">compute_ious</h3>
<div class="codehilite"><pre><span></span><code><span class="n">paz</span><span class="o">.</span><span class="n">backend</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">compute_ious</span><span class="p">(</span><span class="n">boxes_A</span><span class="p">,</span> <span class="n">boxes_B</span><span class="p">)</span>
</code></pre></div>

<p>Calculates the intersection over union between <code>boxes_A</code> and <code>boxes_B</code>.
For each box present in the rows of <code>boxes_A</code> it calculates
the intersection over union with respect to all boxes in <code>boxes_B</code>.
The variables <code>boxes_A</code> and <code>boxes_B</code> contain the corner coordinates
of the left-top corner <code>(x_min, y_min)</code> and the right-bottom
<code>(x_max, y_max)</code> corner.</p>
<p><strong>Arguments</strong></p>
<ul>
<li><strong>boxes_A</strong>: Numpy array with shape <code>(num_boxes_A, 4)</code>.</li>
<li><strong>boxes_B</strong>: Numpy array with shape <code>(num_boxes_B, 4)</code>.</li>
</ul>
<p><strong>Returns</strong></p>
<p>Numpy array of shape <code>(num_boxes_A, num_boxes_B)</code>.</p>
<hr />
<p><span style="float:right;"><a href="https://github.com/oarriaga/paz/blob/master/paz/backend/boxes.py#L70">[source]</a></span></p>
<h3 id="decode">decode</h3>
<div class="codehilite"><pre><span></span><code><span class="n">paz</span><span class="o">.</span><span class="n">backend</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">priors</span><span class="p">,</span> <span class="n">variances</span><span class="o">=</span><span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">])</span>
</code></pre></div>

<p>Decode default boxes into the ground truth boxes</p>
<p><strong>Arguments</strong></p>
<ul>
<li><strong>loc</strong>: Numpy array of shape <code>(num_priors, 4)</code>.</li>
<li><strong>priors</strong>: Numpy array of shape <code>(num_priors, 4)</code>.</li>
<li><strong>variances</strong>: List of two floats. Variances of prior boxes.</li>
</ul>
<p><strong>Returns</strong></p>
<p>decoded boxes: Numpy array of shape <code>(num_priors, 4)</code>.</p>
<hr />
<p><span style="float:right;"><a href="https://github.com/oarriaga/paz/blob/master/paz/backend/boxes.py#L588">[source]</a></span></p>
<h3 id="denormalize_box">denormalize_box</h3>
<div class="codehilite"><pre><span></span><code><span class="n">paz</span><span class="o">.</span><span class="n">backend</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">denormalize_box</span><span class="p">(</span><span class="n">box</span><span class="p">,</span> <span class="n">image_shape</span><span class="p">)</span>
</code></pre></div>

<p>Scales corner box coordinates from normalized values to image dimensions</p>
<p><strong>Arguments</strong></p>
<ul>
<li><strong>box</strong>: Numpy array containing corner box coordinates.</li>
<li><strong>image_shape</strong>: List of integers with (height, width).</li>
</ul>
<p><strong>Returns</strong></p>
<ul>
<li><strong>returns</strong>: box corner coordinates in image dimensions</li>
</ul>
<hr />
<p><span style="float:right;"><a href="https://github.com/oarriaga/paz/blob/master/paz/backend/boxes.py#L40">[source]</a></span></p>
<h3 id="encode">encode</h3>
<div class="codehilite"><pre><span></span><code><span class="n">paz</span><span class="o">.</span><span class="n">backend</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">matched</span><span class="p">,</span> <span class="n">priors</span><span class="p">,</span> <span class="n">variances</span><span class="o">=</span><span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">])</span>
</code></pre></div>

<p>Encode the variances from the priorbox layers into the ground truth
boxes we have matched (based on jaccard overlap) with the prior boxes.</p>
<p><strong>Arguments</strong></p>
<ul>
<li><strong>matched</strong>: Numpy array of shape <code>(num_priors, 4)</code> with boxes in
    point-form.</li>
<li><strong>priors</strong>: Numpy array of shape <code>(num_priors, 4)</code> with boxes in
    center-form.</li>
<li><strong>variances</strong>: (list[float]) Variances of priorboxes</li>
</ul>
<p><strong>Returns</strong></p>
<p>encoded boxes: Numpy array of shape <code>(num_priors, 4)</code>.</p>
<hr />
<p><span style="float:right;"><a href="https://github.com/oarriaga/paz/blob/master/paz/backend/boxes.py#L607">[source]</a></span></p>
<h3 id="flip_left_right">flip_left_right</h3>
<div class="codehilite"><pre><span></span><code><span class="n">paz</span><span class="o">.</span><span class="n">backend</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">flip_left_right</span><span class="p">(</span><span class="n">boxes</span><span class="p">,</span> <span class="n">width</span><span class="p">)</span>
</code></pre></div>

<p>Flips box coordinates from left-to-right and vice-versa.
<strong>Arguments</strong></p>
<ul>
<li><strong>boxes</strong>: Numpy array of shape <code>[num_boxes, 4]</code>.
<strong>Returns</strong></li>
</ul>
<p>Numpy array of shape <code>[num_boxes, 4]</code>.</p>
<hr />
<p><span style="float:right;"><a href="https://github.com/oarriaga/paz/blob/master/paz/backend/boxes.py#L512">[source]</a></span></p>
<h3 id="make_box_square">make_box_square</h3>
<div class="codehilite"><pre><span></span><code><span class="n">paz</span><span class="o">.</span><span class="n">backend</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">make_box_square</span><span class="p">(</span><span class="n">box</span><span class="p">)</span>
</code></pre></div>

<p>Makes box coordinates square with sides equal to the longest
original side.</p>
<p><strong>Arguments</strong></p>
<ul>
<li><strong>box</strong>: Numpy array with shape <code>(4)</code> with point corner coordinates.</li>
</ul>
<p><strong>Returns</strong></p>
<ul>
<li><strong>returns</strong>: List of box coordinates ints.</li>
</ul>
<hr />
<p><span style="float:right;"><a href="https://github.com/oarriaga/paz/blob/master/paz/backend/boxes.py#L180">[source]</a></span></p>
<h3 id="match">match</h3>
<div class="codehilite"><pre><span></span><code><span class="n">paz</span><span class="o">.</span><span class="n">backend</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">boxes</span><span class="p">,</span> <span class="n">prior_boxes</span><span class="p">,</span> <span class="n">iou_threshold</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</code></pre></div>

<p>Matches each prior box with a ground truth box (box from <code>boxes</code>).
It then selects which matched box will be considered positive e.g. iou &gt; .5
and returns for each prior box a ground truth box that is either positive
(with a class argument different than 0) or negative.</p>
<p><strong>Arguments</strong></p>
<ul>
<li><strong>boxes</strong>: Numpy array of shape <code>(num_ground_truh_boxes, 4 + 1)</code>,
    where the first the first four coordinates correspond to
    box coordinates and the last coordinates is the class
    argument. This boxes should be the ground truth boxes.</li>
<li><strong>prior_boxes</strong>: Numpy array of shape <code>(num_prior_boxes, 4)</code>.
    where the four coordinates are in center form coordinates.</li>
<li><strong>iou_threshold</strong>: Float between [0, 1]. Intersection over union
    used to determine which box is considered a positive box.</li>
</ul>
<p><strong>Returns</strong></p>
<p>numpy array of shape <code>(num_prior_boxes, 4 + 1)</code>.
    where the first the first four coordinates correspond to point
    form box coordinates and the last coordinates is the class
    argument.</p>
<hr />
<p><span style="float:right;"><a href="https://github.com/oarriaga/paz/blob/master/paz/backend/boxes.py#L319">[source]</a></span></p>
<h3 id="nms_per_class_1">nms_per_class</h3>
<div class="codehilite"><pre><span></span><code><span class="n">paz</span><span class="o">.</span><span class="n">backend</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">nms_per_class</span><span class="p">(</span><span class="n">box_data</span><span class="p">,</span> <span class="n">nms_thresh</span><span class="o">=</span><span class="mf">0.45</span><span class="p">,</span> <span class="n">epsilon</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">top_k</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
</code></pre></div>

<p>Applies non maximum suppression per class.
This function takes all the detections from the detector which
consists of boxes and their corresponding class scores to which it
applies non maximum suppression for every class independently and
then combines the result.</p>
<p><strong>Arguments</strong></p>
<ul>
<li><strong>box_data</strong>: Array of shape <code>(num_nms_boxes, 4 + num_classes)</code>
    containing the box coordinates as well as the predicted
    scores of all the classes for all non suppressed boxes.</li>
<li><strong>nms_thresh</strong>: Float, Non-maximum suppression threshold.</li>
<li><strong>epsilon</strong>: Float, Filter scores with a lower confidence
    value before performing non-maximum supression.</li>
<li><strong>top_k</strong>: Int, Maximum number of boxes per class outputted by nms.</li>
</ul>
<p><strong>Returns</strong></p>
<ul>
<li><strong>Tuple</strong>: Containing an array non suppressed boxes of shape
    <code>(num_nms_boxes, 4 + num_classes)</code> and an array
    of corresponding class labels of shape <code>(num_nms_boxes, )</code>.</li>
</ul>
<hr />
<p><span style="float:right;"><a href="https://github.com/oarriaga/paz/blob/master/paz/backend/boxes.py#L619">[source]</a></span></p>
<h3 id="to_image_coordinates">to_image_coordinates</h3>
<div class="codehilite"><pre><span></span><code><span class="n">paz</span><span class="o">.</span><span class="n">backend</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">to_image_coordinates</span><span class="p">(</span><span class="n">boxes</span><span class="p">,</span> <span class="n">image</span><span class="p">)</span>
</code></pre></div>

<p>Transforms normalized box coordinates into image coordinates.
<strong>Arguments</strong></p>
<ul>
<li><strong>image</strong>: Numpy array.</li>
<li><strong>boxes</strong>: Numpy array of shape <code>[num_boxes, N]</code> where N &gt;= 4.
<strong>Returns</strong></li>
</ul>
<p>Numpy array of shape <code>[num_boxes, N]</code>.</p>
<hr />
<p><span style="float:right;"><a href="https://github.com/oarriaga/paz/blob/master/paz/backend/boxes.py#L4">[source]</a></span></p>
<h3 id="to_center_form">to_center_form</h3>
<div class="codehilite"><pre><span></span><code><span class="n">paz</span><span class="o">.</span><span class="n">backend</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">to_center_form</span><span class="p">(</span><span class="n">boxes</span><span class="p">)</span>
</code></pre></div>

<p>Transform from corner coordinates to center coordinates.</p>
<p><strong>Arguments</strong></p>
<ul>
<li><strong>boxes</strong>: Numpy array with shape <code>(num_boxes, 4)</code>.</li>
</ul>
<p><strong>Returns</strong></p>
<p>Numpy array with shape <code>(num_boxes, 4)</code>.</p>
<hr />
<p><span style="float:right;"><a href="https://github.com/oarriaga/paz/blob/master/paz/backend/boxes.py#L495">[source]</a></span></p>
<h3 id="to_one_hot">to_one_hot</h3>
<div class="codehilite"><pre><span></span><code><span class="n">paz</span><span class="o">.</span><span class="n">backend</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">to_one_hot</span><span class="p">(</span><span class="n">class_indices</span><span class="p">,</span> <span class="n">num_classes</span><span class="p">)</span>
</code></pre></div>

<p>Transform from class index to one-hot encoded vector.</p>
<p><strong>Arguments</strong></p>
<ul>
<li><strong>class_indices</strong>: Numpy array. One dimensional array specifying
    the index argument of the class for each sample.</li>
<li><strong>num_classes</strong>: Integer. Total number of classes.</li>
</ul>
<p><strong>Returns</strong></p>
<p>Numpy array with shape <code>(num_samples, num_classes)</code>.</p>
<hr />
<p><span style="float:right;"><a href="https://github.com/oarriaga/paz/blob/master/paz/backend/boxes.py#L636">[source]</a></span></p>
<h3 id="to_normalized_coordinates">to_normalized_coordinates</h3>
<div class="codehilite"><pre><span></span><code><span class="n">paz</span><span class="o">.</span><span class="n">backend</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">to_normalized_coordinates</span><span class="p">(</span><span class="n">boxes</span><span class="p">,</span> <span class="n">image</span><span class="p">)</span>
</code></pre></div>

<p>Transforms coordinates in image dimensions to normalized coordinates.
<strong>Arguments</strong></p>
<ul>
<li><strong>image</strong>: Numpy array.</li>
<li><strong>boxes</strong>: Numpy array of shape <code>[num_boxes, N]</code> where N &gt;= 4.
<strong>Returns</strong></li>
</ul>
<p>Numpy array of shape <code>[num_boxes, N]</code>.</p>
<hr />
<p><span style="float:right;"><a href="https://github.com/oarriaga/paz/blob/master/paz/backend/boxes.py#L22">[source]</a></span></p>
<h3 id="to_corner_form">to_corner_form</h3>
<div class="codehilite"><pre><span></span><code><span class="n">paz</span><span class="o">.</span><span class="n">backend</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">to_corner_form</span><span class="p">(</span><span class="n">boxes</span><span class="p">)</span>
</code></pre></div>

<p>Transform from center coordinates to corner coordinates.</p>
<p><strong>Arguments</strong></p>
<ul>
<li><strong>boxes</strong>: Numpy array with shape <code>(num_boxes, 4)</code>.</li>
</ul>
<p><strong>Returns</strong></p>
<p>Numpy array with shape <code>(num_boxes, 4)</code>.</p>
<hr />
<p><span style="float:right;"><a href="https://github.com/oarriaga/paz/blob/master/paz/backend/boxes.py#L653">[source]</a></span></p>
<h3 id="extract_bounding_box_corners">extract_bounding_box_corners</h3>
<div class="codehilite"><pre><span></span><code><span class="n">paz</span><span class="o">.</span><span class="n">backend</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">extract_bounding_box_corners</span><span class="p">(</span><span class="n">points3D</span><span class="p">)</span>
</code></pre></div>

<p>Extracts the (x_min, y_min, z_min) and the (x_max, y_max, z_max)
coordinates from an array of  points3D
<strong>Arguments</strong></p>
<ul>
<li><strong>points3D</strong>: Array (num_points, 3)</li>
</ul>
<p><strong>Returns</strong></p>
<p>Left-down-bottom corner (x_min, y_min, z_min) and right-up-top
    (x_max, y_max, z_max) corner.</p>
<hr />
<p><span style="float:right;"><a href="https://github.com/oarriaga/paz/blob/master/paz/backend/boxes.py#L687">[source]</a></span></p>
<h3 id="scale_box">scale_box</h3>
<div class="codehilite"><pre><span></span><code><span class="n">paz</span><span class="o">.</span><span class="n">backend</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">scale_box</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">image_scales</span><span class="p">)</span>
</code></pre></div>

<p><strong>Arguments</strong></p>
<ul>
<li><strong>predictions</strong>: Array of shape <code>(num_boxes, num_classes+N)</code>
    model predictions.</li>
<li><strong>image_scales</strong>: Array of shape <code>()</code>, scale value of boxes.</li>
</ul>
<p><strong>Returns</strong></p>
<ul>
<li><strong>predictions</strong>: Array of shape <code>(num_boxes, num_classes+N)</code>
    model predictions.</li>
</ul>
<hr />
<p><span style="float:right;"><a href="https://github.com/oarriaga/paz/blob/master/paz/backend/boxes.py#L705">[source]</a></span></p>
<h3 id="change_box_coordinates">change_box_coordinates</h3>
<div class="codehilite"><pre><span></span><code><span class="n">paz</span><span class="o">.</span><span class="n">backend</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">change_box_coordinates</span><span class="p">(</span><span class="n">outputs</span><span class="p">)</span>
</code></pre></div>

<p>Converts box coordinates format from (y_min, x_min, y_max, x_max)
to (x_min, y_min, x_max, y_max).</p>
<p><strong>Arguments</strong></p>
<ul>
<li><strong>outputs</strong>: Tensor, model output.</li>
</ul>
<p><strong>Returns</strong></p>
<ul>
<li><strong>outputs</strong>: Array, Processed outputs by merging the features
    at all levels. Each row corresponds to box coordinate
    offsets and sigmoid of the class logits.</li>
</ul>
<hr />
<p><span style="float:right;"><a href="https://github.com/oarriaga/paz/blob/master/paz/backend/boxes.py#L727">[source]</a></span></p>
<h3 id="add_class_and_score">add_class_and_score</h3>
<div class="codehilite"><pre><span></span><code><span class="n">paz</span><span class="o">.</span><span class="n">backend</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">add_class_and_score</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">box</span><span class="p">)</span>
</code></pre></div>

<p>Adds class and score to box.</p>
<p><strong>Arguments</strong></p>
<ul>
<li><strong>predictions</strong>: Dictionary with keys <code>class_name</code> and <code>scores</code>.</li>
<li><strong>box</strong>: Array of shape <code>(num_nms_boxes, 4 + num_classes)</code>.</li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.f1b6f286.min.js"></script>
      
    
  </body>
</html>